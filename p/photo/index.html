<!--
 * @Author: your name
 * @Date: 2021-08-18 22:11:52
 * @LastEditTime: 2021-11-24 19:45:43
 * @LastEditors: Please set LastEditors
 * @Description: 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
 * @FilePath: /grammyli/seamles/index.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>无缝轮播图</title>
    <link href="../../cv/assets/img/davizi.jpg" rel="icon">
    <style>
        .img-container {
            position: relative;
            width: 400px;
            height: 300px;
            overflow: hidden;
        }

        img {
            width: 400px;
            height: 300px;
            position: absolute;
        }

        /* img:nth-child(1) {
            left: 50px;
        }
        img:nth-child(2) {
            left: 100px;
        }
        img:nth-child(3) {
            left: 150px;
        } */
    </style>
</head>

<body>
    <div class="img-container">
        <img class="grammy-img" data-index="0" src='img/4.jpeg' />
        <img class="grammy-img" data-index="1" src='img/5.jpeg' />
        <img class="grammy-img" data-index="2" src='img/6.jpg' />
    </div>
    <!-- <button class="btn-pre">pre</button>

    <button class="btn-next">next</button> -->

    <script src="./utils.js"></script>
    <script>
        const init = () => {
            for (let i = 0; i < imgs.length; i++) {
                let m = imgs[i]
                let w = width * i
                m.style.left = `${w}px`
                m.style.transition = 'all 0.5s'
            }
        }
        const autoMoveImg = (fps = 2000) => {
            setInterval(() => {
                for (let i = 0; i < imgs.length; i++) {
                    let m = imgs[i]
                    let left = int(m.style.left)
                    let w = left - width
                    m.style.left = `${w}px`
                }
            }, fps)
        }

        const bindEventTransition = () => {
            bindAll('img', 'transitionend', event => {
                // log('end')
                const m = event.target
                const i = m.dataset.index
                const left = int(m.style.left)
                if (left < 0) {
                    m.style.transition = 'none'
                    // 移动到最后一张
                    let w = width * (imgs.length - 1)
                    m.style.left = `${w}px`

                    setTimeout(() => {
                        m.style.transition = 'all 0.5s'
                    })
                }
            })
        }

        const __main = () => {
            window.width = 400
            window.imgs = es('img')
            init()
            autoMoveImg()
            bindEventTransition()
        }
        __main()

    </script>
</body>

</html>