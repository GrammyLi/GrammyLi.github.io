<!--
 * @Author: your name
 * @Date: 2021-10-11 18:53:04
 * @LastEditTime: 2021-10-11 19:24:35
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /grammyli/avatar/1.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>download </title>
  <style>
    canvas {
      border: solid 1px #000;
    }
  </style>
</head>

<body>
  <canvas id="exampleCanvas" width="400" height="400">

  </canvas>
  <button type="button" onClick="download()">Download</button>

  <script src="./utils.js"></script>
  <script>
    var canvas = document.getElementById('exampleCanvas'),
      context = canvas.getContext('2d');

    context.beginPath();
    context.moveTo(50, 50);
    context.lineTo(250, 150);
    context.stroke();
   
    const imgUrl = `https://grammyli.com/avatar/img/flag/hat2.png`
    // log('imgUrl', imgUrl)
    const img = new Image()
    img.setAttribute('crossorigin', 'anonymous')
    img.src = imgUrl
    // img.setAttribute("crossOrigin",'Anonymous')
    img.onload = () => {
      context.drawImage(img, 0, 0, 400, 400)
    }

    const saveAsPNG = () => {
      // let canvasImage = document.getElementById('canvas').toDataURL('image/png');
      // log('canvasImage', canvasImage)
      const canvas = e('canvas')
      log('canvas', canvas)
      return canvas.toDataURL("image/png")
    }

    function download() {
      // var download = document.getElementById("download");
      // log('canvas', document.getElementById("exampleCanvas"))
      // var image = document.getElementById("exampleCanvas").toDataURL("image/png")
      //   .replace("image/png", "image/octet-stream");
      // download.setAttribute("href", image);
      let a = document.createElement("a")
      a.download = 'flag-avatar'
      log('saveAsPNG() ', saveAsPNG())
      a.href = saveAsPNG()
      log('a.href', a.href)
      document.body.appendChild(a)
      a.click()
      a.remove()

    }
  </script>
</body>

</html>